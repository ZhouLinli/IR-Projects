---
title: "ParentSurvey"
format: 
  pdf:
    keep-md: true
    include-in-header:
      - text: |
          \usepackage{fancyhdr}
          \addtolength{\headheight}{0.7cm}
    
          \pagestyle{fancy} 
          \fancyhead{}
          \fancyfoot{}
    
          \fancyhead[LO]{\includegraphics[height=1.3cm]{/Users/linlizhou/Documents/Rprojects/IR.png}}
          \fancyhead[RE]{\vspace{4mm}\textbf{AAC Courses Review}}
          \fancyfoot[C]{\thepage}
    
          \renewcommand{\headrulewidth}{0pt}
editor: visual
---

```{r libraries, include = FALSE}
source("/Users/linlizhou/Documents/Rprojects/IR-Projects/theme_source.R")
```

```{r load_rawdf.surveyexport}
raw<-read_csv("/Volumes/lasellshare/Faculty_Staff_Shares$/IR/Surveys/Lasell Internal/Parent Survey/fall 2022/20221213114001-SurveyExport.csv")
lapply(raw[1:60], unique)
```

```{r parentdf.andcleancols}
#remove unnecessary starter cols
parent<-raw%>%
  #remove unnecessary starter cols
  select(-(`Response ID`:`Date Submitted`),#keep status
                     -(`Contact ID`: `Invite Status`),#keep email
                     -(`First Name`:Source),
                     -(`Invite Custom Field 1`:`Invite Custom Field 10`))%>%
  #remove empty rows/cols (including header has to be NA)
  janitor::remove_empty(c("rows", "cols"))

#remove NA cols
parent<-parent[ , colSums(is.na(parent)) < nrow(parent)] #sum each col's # of NA rows, not all rows are NA

# convinient col names:
parent<-janitor::clean_names(parent)

#284 rows/observations
#look at the survey instruction:
```

```{r parent_rename}
#rename cols: 
# refer back to survey questions pdf
# lapply(parent[4:ncol(parent)-1], unique)

#rule: same question same starter_texts
parent<-parent%>%rename(
## 1 satisfaction
satis.overall=overall_how_satisfied_are_you_with_your_childs_undergraduate_education_so_far,

#1.1 academic satisfaction
satis.aca_instruct=overall_quality_of_instruction_as_a_parent_guardian_how_satisfied_are_you_with_the_quality_of_each_of_the_following_aspects_of_your_students_academic_experience_at_lasell_if_any_aspect_does_not_apply_please_select_n_a,

satis.aca_advise=quality_of_academic_advising_as_a_parent_guardian_how_satisfied_are_you_with_the_quality_of_each_of_the_following_aspects_of_your_students_academic_experience_at_lasell_if_any_aspect_does_not_apply_please_select_n_a,

satis.aca_faculty=contact_with_faculty_as_a_parent_guardian_how_satisfied_are_you_with_the_quality_of_each_of_the_following_aspects_of_your_students_academic_experience_at_lasell_if_any_aspect_does_not_apply_please_select_n_a,

satis.aca_tutor=tutoring_and_other_academic_help_as_a_parent_guardian_how_satisfied_are_you_with_the_quality_of_each_of_the_following_aspects_of_your_students_academic_experience_at_lasell_if_any_aspect_does_not_apply_please_select_n_a,

#1.2 service satisfaction
satis.sv_house=student_housing_as_a_parent_guardian_how_satisfied_are_you_with_the_quality_of_each_of_the_following_aspects_of_campus_services_and_facilities_at_lasell_if_any_aspect_does_not_apply_please_select_n_a,

satis.sv_career=career_counseling_as_a_parent_guardian_how_satisfied_are_you_with_the_quality_of_each_of_the_following_aspects_of_campus_services_and_facilities_at_lasell_if_any_aspect_does_not_apply_please_select_n_a,

satis.sv_parent=the_office_of_parent_engagement_as_a_parent_guardian_how_satisfied_are_you_with_the_quality_of_each_of_the_following_aspects_of_campus_services_and_facilities_at_lasell_if_any_aspect_does_not_apply_please_select_n_a,

satis.sv_dine=dining_as_a_parent_guardian_how_satisfied_are_you_with_the_quality_of_each_of_the_following_aspects_of_campus_services_and_facilities_at_lasell_if_any_aspect_does_not_apply_please_select_n_a,

satis.sv_fin=financial_aid_office_as_a_parent_guardian_how_satisfied_are_you_with_the_quality_of_each_of_the_following_aspects_of_campus_services_and_facilities_at_lasell_if_any_aspect_does_not_apply_please_select_n_a,

satis.sv_health=health_services_as_a_parent_guardian_how_satisfied_are_you_with_the_quality_of_each_of_the_following_aspects_of_campus_services_and_facilities_at_lasell_if_any_aspect_does_not_apply_please_select_n_a,

satis.sv_mental=mental_health_counseling_as_a_parent_guardian_how_satisfied_are_you_with_the_quality_of_each_of_the_following_aspects_of_campus_services_and_facilities_at_lasell_if_any_aspect_does_not_apply_please_select_n_a,

satis.sv_account=financial_services_student_accounts_as_a_parent_guardian_how_satisfied_are_you_with_the_quality_of_each_of_the_following_aspects_of_campus_services_and_facilities_at_lasell_if_any_aspect_does_not_apply_please_select_n_a,

satis.sv_police=campus_police_as_a_parent_guardian_how_satisfied_are_you_with_the_quality_of_each_of_the_following_aspects_of_campus_services_and_facilities_at_lasell_if_any_aspect_does_not_apply_please_select_n_a,

#1.3 life satisfaction

satis.life_safe=your_students_safety_on_campus_as_a_parent_guardian_how_satisfied_are_you_with_the_quality_of_each_of_the_following_aspects_of_campus_life_at_lasell_if_any_aspect_does_not_apply_please_select_n_a,

satis.life_race=ethnic_and_racial_diversity_on_campus_as_a_parent_guardian_how_satisfied_are_you_with_the_quality_of_each_of_the_following_aspects_of_campus_life_at_lasell_if_any_aspect_does_not_apply_please_select_n_a,

satis.life_belong=sense_of_community_on_campus_as_a_parent_guardian_how_satisfied_are_you_with_the_quality_of_each_of_the_following_aspects_of_campus_life_at_lasell_if_any_aspect_does_not_apply_please_select_n_a,

satis.life_social=social_life_on_campus_as_a_parent_guardian_how_satisfied_are_you_with_the_quality_of_each_of_the_following_aspects_of_campus_life_at_lasell_if_any_aspect_does_not_apply_please_select_n_a,

## information
#2.1 info on food committee

infofood_knowcommittee=are_you_aware_that_there_is_a_student_run_food_committee_that_is_open_to_all_students_and_meets_twice_a_month_on_thursdays_with_the_director_of_dining_services_and_vice_president_of_administrative_services,

infofood_attendcommittee=has_your_student_attended_one_of_those_meetings_of_student_run_food_committee_to_share_comments_and_concerns,

infofood_committeequal=other_write_in_has_your_student_attended_one_of_those_meetings_of_student_run_food_committee_to_share_comments_and_concerns,

infofood_try=would_you_be_interested_in_coming_to_lasell_to_try_the_food,

#2.2 info received/need
inforecv_counsel=counseling_services_please_rate_each_of_the_following_areas_on_the_information_you_have_received_about_this_area_relative_to_your_needs,

inforecv_athletic=athletics_please_rate_each_of_the_following_areas_on_the_information_you_have_received_about_this_area_relative_to_your_needs,

inforecv_finaid=financial_aid_please_rate_each_of_the_following_areas_on_the_information_you_have_received_about_this_area_relative_to_your_needs,

inforecv_prtevent=events_for_parents_i_e_family_friends_alumni_weekend_webinars_please_rate_each_of_the_following_areas_on_the_information_you_have_received_about_this_area_relative_to_your_needs,

inforecv_acapolicy=academic_life_and_policies_please_rate_each_of_the_following_areas_on_the_information_you_have_received_about_this_area_relative_to_your_needs,

inforecv_activity=off_campus_programs_i_e_study_abroad_please_rate_each_of_the_following_areas_on_the_information_you_have_received_about_this_area_relative_to_your_needs,

inforecv_career=career_counseling_please_rate_each_of_the_following_areas_on_the_information_you_have_received_about_this_area_relative_to_your_needs,

inforecv_health=health_services_please_rate_each_of_the_following_areas_on_the_information_you_have_received_about_this_area_relative_to_your_needs,

inforecv_house=residential_life_and_policies_please_rate_each_of_the_following_areas_on_the_information_you_have_received_about_this_area_relative_to_your_needs,

inforecv_event=special_events_on_campus_please_rate_each_of_the_following_areas_on_the_information_you_have_received_about_this_area_relative_to_your_needs,

inforecv_resource=resources_for_parents_i_e_office_of_parent_engagement_parents_council_please_rate_each_of_the_following_areas_on_the_information_you_have_received_about_this_area_relative_to_your_needs,

inforecv_acasupport=academic_support_services_i_e_tutoring_please_rate_each_of_the_following_areas_on_the_information_you_have_received_about_this_area_relative_to_your_needs,

inforecv_religion=religious_life_please_rate_each_of_the_following_areas_on_the_information_you_have_received_about_this_area_relative_to_your_needs,

inforecv_stuorg=student_organizations_please_rate_each_of_the_following_areas_on_the_information_you_have_received_about_this_area_relative_to_your_needs,

inforecv_finoption=financing_options_i_e_installments_pre_pay_please_rate_each_of_the_following_areas_on_the_information_you_have_received_about_this_area_relative_to_your_needs,

inforecv_safe=campus_safety_please_rate_each_of_the_following_areas_on_the_information_you_have_received_about_this_area_relative_to_your_needs,

#2.3 info relied on
inforely_stu=talking_with_my_student_to_what_extent_do_you_rely_on_each_of_the_following_sources_for_information_about_college_life_and_policies,

inforely_mainweb=visiting_the_main_lasell_website_to_what_extent_do_you_rely_on_each_of_the_following_sources_for_information_about_college_life_and_policies,

inforely_call=calling_someone_at_lasell_to_what_extent_do_you_rely_on_each_of_the_following_sources_for_information_about_college_life_and_policies,

inforely_parent=talking_with_other_parents_to_what_extent_do_you_rely_on_each_of_the_following_sources_for_information_about_college_life_and_policies,

inforely_prtweb=visiting_the_parents_and_families_webpage_to_what_extent_do_you_rely_on_each_of_the_following_sources_for_information_about_college_life_and_policies,
  
inforely_facebook=using_the_parents_network_facebook_group_to_what_extent_do_you_rely_on_each_of_the_following_sources_for_information_about_college_life_and_policies,

inforely_email=emails_from_the_office_of_parent_engagement_or_another_office_to_what_extent_do_you_rely_on_each_of_the_following_sources_for_information_about_college_life_and_policies,

#2.4 info from students
infoconv_aca=current_academic_matters_how_often_do_you_discuss_each_of_the_following_with_your_student,

infoconv_gradplan=graduate_school_plans_how_often_do_you_discuss_each_of_the_following_with_your_student,

infoconv_career=career_plans_how_often_do_you_discuss_each_of_the_following_with_your_student,

infoconv_fin=finances_how_often_do_you_discuss_each_of_the_following_with_your_student,

infoconv_campus=campus_life_how_often_do_you_discuss_each_of_the_following_with_your_student,

infoconv_health=your_students_physical_or_emotional_health_how_often_do_you_discuss_each_of_the_following_with_your_student,

## 3. events
# 3.1 attended events
evted_townhall=did_you_attend_the_virtual_parents_town_hall_in_october,
evted_townhall_qual=please_share_your_thoughts_recommendation_for_the_virtual_parent_town_hall_you_attended_in_october,

evted_wkend=did_you_attend_family_friends_and_alumni_weekend,
evt_wkend_qual=please_share_your_thoughts_recommendation_for_the_family_friends_and_alumni_weekend_you_attended,

evted_recept=did_you_attend_the_2022_parents_reception,
evted_recept_qual=please_share_your_thoughts_recommendation_for_the_2022_parents_reception_you_attended,

# 3.2 will attend events
evtwill_recept=will_you_be_attending_the_2023_parents_reception_a_parent_only_event_to_meet_other_parents_president_and_other_lasell_staff_members_this_is_a_free_event_which_will_likely_happen_on_a_weekend_in_april_and_will_be_held_on_campus_in_dunne_house,

evtwill_know=a_get_to_know_you_activity_with_other_parents_guardians_what_types_of_webinars_do_you_wish_the_office_of_parent_engagement_to_offer_in_the_spring,

evtwill_staff=opportunity_to_meet_the_deans_and_other_faculty_members_what_types_of_webinars_do_you_wish_the_office_of_parent_engagement_to_offer_in_the_spring,

evtwill_senior=parents_guardians_of_seniors_to_discuss_what_comes_next_after_lasell_and_what_seniors_should_be_doing_to_prepare_for_graduation_what_types_of_webinars_do_you_wish_the_office_of_parent_engagement_to_offer_in_the_spring,

evtwill_social=open_discussion_with_staff_members_for_parents_guardians_with_students_struggling_to_get_involved_or_make_friends_what_types_of_webinars_do_you_wish_the_office_of_parent_engagement_to_offer_in_the_spring,

evtwill_otheropt=other_write_in_required_what_types_of_webinars_do_you_wish_the_office_of_parent_engagement_to_offer_in_the_spring_168,

evtwill_otherqual=other_write_in_required_what_types_of_webinars_do_you_wish_the_office_of_parent_engagement_to_offer_in_the_spring_169,

## overall

satis.overall_qual=please_share_any_additional_questions_or_comments_about_your_experiences_as_a_parent_or_guardian_of_a_lasell_students
)
```

```{r parent_rmmorecols}
#check: lapply(parent[3:ncol(parent)-1], unique)
parent<-parent%>%select(-(academic_how_often_do_you_discuss_each_of_the_following_with_your_student:no_idea_what_he_wants_to_do_and_school_no_resources_how_often_do_you_discuss_each_of_the_following_with_your_student))
```

```{r qualvsquan}
parent.quan<-parent%>%select(!ends_with("qual"))#check: %>%names()#61
parent.qual<-parent%>%select(ends_with("qual"))#check: %>%names()#6
```


```{r parent.long_group.cols}
#check: lapply(parent.quan, unique)
#names(parent.quan)
parent.satis<-parent.quan%>%select(starts_with("satis"))%>%
  #group similar items together as one variable
  pivot_longer(cols=starts_with("satis.aca"),names_to="satis.aca",values_to="satis.aca_value")%>%
  pivot_longer(cols=starts_with("satis.sv"),names_to="satis.sv",values_to="satis.sv_value")%>%
  pivot_longer(cols=starts_with("satis.life"),names_to="satis.life",values_to="satis.life_value")

parent.info<-parent.quan%>%select(starts_with("info"))%>%
  pivot_longer(cols=starts_with("infofood"),names_to="infofood",values_to="infofood_value")%>%
  pivot_longer(cols=starts_with("inforecv"),names_to="inforecv",values_to="inforecv_value")%>%
  pivot_longer(cols=starts_with("inforely"),names_to="inforely",values_to="inforely_value")%>%
  pivot_longer(cols=starts_with("infoconv"),names_to="infoconv",values_to="infoconv_value")

parent.evt<-parent.quan%>%select(starts_with("evt"))%>%
  pivot_longer(cols=starts_with("evted"),names_to="evted",values_to="evted_value")%>%
  pivot_longer(cols=starts_with("evtwill"),names_to="evtwill",values_to="evtwill_value")
```

```{r save_parent_commentout}
#wb<-createWorkbook()

#addWorksheet(wb,"parent")
#writeData(wb,sheet = "parent",x=parent)

#addWorksheet(wb,"parent.quan")
#writeData(wb,sheet = "parent.quan",x=parent.quan)

#addWorksheet(wb,"parent.qual")
#writeData(wb,sheet = "parent.qual",x=parent.qual)

#addWorksheet(wb,"parent.satis")
#writeData(wb,"parent.satis",x=parent.satis)
#addWorksheet(wb,"parent.info")
#writeData(wb,"parent.info",x=parent.info)
#addWorksheet(wb,"parent.evt")
#writeData(wb,"parent.evt",x=parent.evt)

#saveWorkbook(wb,"/Volumes/lasellshare/Faculty_Staff_Shares$/IR/Surveys/Lasell Internal/Parent Survey/fall 2022/parentsurveyworking.xlsx",overwrite = TRUE)
```

## Survey Responses
```{r responserate,include=TRUE}
contactlist<-read_excel("/Volumes/lasellshare/Faculty_Staff_Shares$/IR/Surveys/Lasell Internal/Parent Survey/fall 2022/FY23 ALL Parents Email List.xls")
#population N: nrow(contactlist)
#sample N: nrow(parent)

#sample by status
sample.status<-parent%>%count(status)

#construct a tibble
tibble(items=c("complete","partial","not respond"),
       values=c(sample.status[sample.status$status=="Complete",]$n,
                sample.status[sample.status$status=="Partial",]$n,
                nrow(contactlist)-nrow(parent)))%>%
  mutate(prt=values/sum(values))%>%
#create a donut chart
ggplot(aes(x=2, y = values, fill=items)) + geom_bar(stat="identity") +
   xlim(0.5, 2.5)+ coord_polar(theta="y",start=0)+ #circled coord, pie centered on 2; show .5-2.5 of pie (0-.5 is the hole)
  scale_fill_manual(values = c(color_blue_lasell,"grey","#69b3e7"))+#,labels=c("..","..",..);number of colors and legend labels are based on how many groups

  annotate("text",x = 0.5, y = 0.5, fontface="bold", label = str_wrap( "19% Response Rate", width=10))+#0.5 is centered location
  annotate("text",x = 0.5, y = 0.75, hjust=2.8,fontface="bold", label = str_wrap( "81%", width=10))+#left data label
  annotate("text",x = 2, y = 0.75, hjust=1.5,fontface="bold", label = str_wrap( "15%", width=10))+#right data label
  annotate("text",x = 2, y = 0.75,hjust=0, fontface="bold", label = str_wrap( "4%", width=10))+#upperright data label
    theme_lz()+labs(title="",x="",y="",fill="",subtitle = "")
```

```{r}

```


